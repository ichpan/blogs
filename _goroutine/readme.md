## GoRoutine
> 使用并发的方式，将任务分配给多个gorotine去完成。

### 进程和线程
- 进程就是程序在操作系统中的一次执行过程，是系统进行资源分配和调度的最小单位
- 线程是进程的一个执行实例，是程序执行的最小单位。
- 一个进程可以创建和销毁多个线程，同一个进程中的多个线程可以并发执行。
- 一个程序至少有一个进程，一个进程至少有一个线程

### 并发和并行
- 多线程程序在单核上运行，就是并发
- 多个任务作用在单个Cpu上
- 多线程程序在多核上运行，就是并行
  - 多个任务作用在多个Cpu上
  - 并行的速度大于并发

### Go协程和主线程
**主线程**：
- 就是主程序：一个Go的主程序可以起多个协程
- 主线程是一个物理线程，直接作用在cpu上。是重量级的,非常消耗cpu资源。

**协程的特点**：
- 有独立的栈空间
- 共享程序堆空间
- 调度由用户控制
- 协程是一个轻量级的用户态的轻量级线程
- 协程是从主线程开启的,是轻量级的线程，是逻辑态,对资源消耗相对小
- Golang的协程机制是重要的特点,可以轻松的开启上万个线程。其他编程语言的并发机制是一般基于线程的,开启过多的线程,资源耗费大,这里更加可以体现出Golang在并发上的优势了

### MPG模式
> goroutine的调度模型

M：操作系统的主线程
P：协程执行需要的上下文
G：协程

### 设置GoLang运行的Cpu数量
~~~go
// 在版本1.8之后，默认让程序运行在多核上，可以不设置
// 获取当前操作系统的cpu数量
CpuNum := runtime.NumCPU()
runtime.GOMAXPROCS(CpuNum)
~~~

### 全局互斥锁解决资源竞争问题
~~~go
// sync.Mutex提供加锁和释放锁
lock.Lock()
lock.Unlock()
~~~